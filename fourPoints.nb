(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     63151,       1680]
NotebookOptionsPosition[     58875,       1541]
NotebookOutlinePosition[     59253,       1557]
CellTagsIndexPosition[     59210,       1554]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"fourPoints", ".", "nb"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.6740566130807457`*^9, 3.674056618977659*^9}, {
  3.674056671971878*^9, 3.6740568149486275`*^9}, {3.674403468377522*^9, 
  3.674403482417612*^9}, {3.6744035481876335`*^9, 3.6744035865170794`*^9}, {
  3.6745647415351872`*^9, 3.674564744639607*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Import", " ", 
     RowBox[{"Zhang", "'"}], "s", " ", "file"}], ",", " ", 
    RowBox[{"using", " ", "relative", " ", 
     RowBox[{"path", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Import", "[", "\"\<BasisDet-1-02.m\>\"", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.674056816524253*^9, 3.674056887427162*^9}, {
   3.6740569183467584`*^9, 3.674056995552148*^9}, 3.6742342604465113`*^9, {
   3.6742345476131525`*^9, 3.6742345967378674`*^9}, 3.674403173083229*^9}],

Cell[BoxData["\<\"\\\\\\\\Client\\\\C$\\\\Users\\\\RSameshima\\\\Desktop\\\\\
Mathematica\"\>"], "Output",
 CellChangeTimes->{{3.6745650138505325`*^9, 3.674565027861729*^9}, 
   3.6745806266946764`*^9, 3.67484180600305*^9, 3.674846098854168*^9, 
   3.6748996845916867`*^9, 3.674902712953018*^9, 3.674903305398016*^9, 
   3.6749073936694226`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"D", " ", "=", " ", 
     RowBox[{"4", " ", "-", " ", 
      RowBox[{"2", " ", "\[Epsilon]"}]}]}], ",", " ", 
    RowBox[{"one", " ", "loop"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Essentially", " ", "copy", " ", "and", " ", "paste", " ", "from", " ", 
    "Zhang`s", " ", 
    RowBox[{"code", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"L", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Dim", " ", "=", " ", 
     RowBox[{"4", " ", "-", 
      RowBox[{"2", " ", "\[Epsilon]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"n", "=", "4"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ExternalMomentaBasis", "=", 
     RowBox[{"{", 
      RowBox[{"p1", ",", "p2", ",", "p4"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Massless", " ", "case"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Kinematics", "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"p1", "^", "2"}], "\[Rule]", "0"}], ",", 
       RowBox[{
        RowBox[{"p2", "^", "2"}], "\[Rule]", "0"}], ",", 
       RowBox[{
        RowBox[{"p4", "^", "2"}], "\[Rule]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p1", " ", "p2"}], "\[Rule]", 
        RowBox[{"s", "/", "2"}]}], ",", 
       RowBox[{
        RowBox[{"p1", " ", "p4"}], "\[Rule]", 
        RowBox[{"t", "/", "2"}]}], ",", 
       RowBox[{
        RowBox[{"p2", " ", "p4"}], "\[Rule]", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{"s", "+", "t"}], ")"}]}], "/", "2"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Omega]1", "^", "2"}], "\[Rule]", 
        RowBox[{
         RowBox[{"-", "t"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"s", "+", "t"}], ")"}], "/", "s"}]}]}]}], " ", 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Props", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"l1", ",", " ", 
       RowBox[{"l1", "+", "p1"}], ",", " ", 
       RowBox[{"l1", "+", "p1", "+", "p2"}], ",", " ", 
       RowBox[{"l1", "-", "p4"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RenormalizationCondition", "=", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "1", "}"}], ",", "4"}], "}"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"GenerateBasis", "[", "1", "]"}], "\[IndentingNewLine]", 
   RowBox[{"Delta4", " ", "=", "Integrand"}]}]}]], "Input",
 CellChangeTimes->{{3.674057017267627*^9, 3.674057375758556*^9}, {
   3.674057464460725*^9, 3.6740575072985992`*^9}, {3.6740575453940434`*^9, 
   3.6740575730530205`*^9}, {3.6740576911925783`*^9, 3.674057708945492*^9}, {
   3.674242438361353*^9, 3.6742424485170174`*^9}, {3.674315486090181*^9, 
   3.6743154967294493`*^9}, {3.6743155703619213`*^9, 3.674315576773562*^9}, {
   3.6743156449927993`*^9, 3.6743156815906343`*^9}, {3.6743157638655615`*^9, 
   3.674315778108453*^9}, {3.6743158256419573`*^9, 3.6743158513977222`*^9}, {
   3.6743159038452587`*^9, 3.67431590567047*^9}, {3.67431593832148*^9, 
   3.6743159421123037`*^9}, {3.6743159897394094`*^9, 3.67431603660211*^9}, {
   3.6743160718762426`*^9, 3.6743160939971848`*^9}, {3.6743161959594383`*^9, 
   3.674316197347847*^9}, {3.6744027418964653`*^9, 3.6744027422864676`*^9}, 
   3.6744036701648154`*^9, {3.6744039939760914`*^9, 3.6744040221186714`*^9}, {
   3.6745649301715965`*^9, 3.674564982525532*^9}, {3.6745650392654023`*^9, 
   3.6745650639447603`*^9}, {3.674901072407783*^9, 3.6749010973523426`*^9}, {
   3.674903268488179*^9, 3.6749032699389887`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Physical spacetime basis is \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"p1", ",", "p2", ",", "p4", ",", "\[Omega]1"}], "}"}]}],
  SequenceForm[
  "Physical spacetime basis is ", {$CellContext`p1, $CellContext`p2, \
$CellContext`p4, $CellContext`\[Omega]1}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.674565031621353*^9, 3.674565064584365*^9}, 
   3.674580630048698*^9, 3.674841807859462*^9, 3.674846103534198*^9, 
   3.674899687290504*^9, {3.6749010772282143`*^9, 3.674901098132348*^9}, 
   3.6749027177422485`*^9, 3.6749033109360514`*^9, 3.6749073959158373`*^9}],

Cell[BoxData["\<\"Extra dimension is turned on.\"\>"], "Print",
 CellChangeTimes->{{3.674565031621353*^9, 3.674565064584365*^9}, 
   3.674580630048698*^9, 3.674841807859462*^9, 3.674846103534198*^9, 
   3.674899687290504*^9, {3.6749010772282143`*^9, 3.674901098132348*^9}, 
   3.6749027177422485`*^9, 3.6749033109360514`*^9, 3.674907395947037*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Number of irreducible scalar products: \"\>", 
   "\[InvisibleSpace]", "2"}],
  SequenceForm["Number of irreducible scalar products: ", 2],
  Editable->False]], "Print",
 CellChangeTimes->{{3.674565031621353*^9, 3.674565064584365*^9}, 
   3.674580630048698*^9, 3.674841807859462*^9, 3.674846103534198*^9, 
   3.674899687290504*^9, {3.6749010772282143`*^9, 3.674901098132348*^9}, 
   3.6749027177422485`*^9, 3.6749033109360514`*^9, 3.6749073959938374`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Irreducible Scalar Products:\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"x14", ",", "\[Mu]11"}], "}"}]}],
  SequenceForm[
  "Irreducible Scalar Products:", {$CellContext`x14, $CellContext`\[Mu]11}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.674565031621353*^9, 3.674565064584365*^9}, 
   3.674580630048698*^9, 3.674841807859462*^9, 3.674846103534198*^9, 
   3.674899687290504*^9, {3.6749010772282143`*^9, 3.674901098132348*^9}, 
   3.6749027177422485`*^9, 3.6749033109360514`*^9, 3.6749073959938374`*^9}],

Cell[BoxData["\<\"Cut equations for ISP are listed in the variable \
'CutEqnISP'\"\>"], "Print",
 CellChangeTimes->{{3.674565031621353*^9, 3.674565064584365*^9}, 
   3.674580630048698*^9, 3.674841807859462*^9, 3.674846103534198*^9, 
   3.674899687290504*^9, {3.6749010772282143`*^9, 3.674901098132348*^9}, 
   3.6749027177422485`*^9, 3.6749033109360514`*^9, 3.6749073959938374`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Possible renormalizable terms: \"\>", "\[InvisibleSpace]", 
   "9"}],
  SequenceForm["Possible renormalizable terms: ", 9],
  Editable->False]], "Print",
 CellChangeTimes->{{3.674565031621353*^9, 3.674565064584365*^9}, 
   3.674580630048698*^9, 3.674841807859462*^9, 3.674846103534198*^9, 
   3.674899687290504*^9, {3.6749010772282143`*^9, 3.674901098132348*^9}, 
   3.6749027177422485`*^9, 3.6749033109360514`*^9, 3.674907396040638*^9}],

Cell[BoxData["\<\"\"\>"], "Print",
 CellChangeTimes->{{3.674565031621353*^9, 3.674565064584365*^9}, 
   3.674580630048698*^9, 3.674841807859462*^9, 3.674846103534198*^9, 
   3.674899687290504*^9, {3.6749010772282143`*^9, 3.674901098132348*^9}, 
   3.6749027177422485`*^9, 3.6749033109360514`*^9, 3.674907396040638*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"The basis contains \"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\" terms, which are listed in the variable 'Basis'\
\"\>"}],
  SequenceForm[
  "The basis contains ", 5, 
   " terms, which are listed in the variable 'Basis'"],
  Editable->False]], "Print",
 CellChangeTimes->{{3.674565031621353*^9, 3.674565064584365*^9}, 
   3.674580630048698*^9, 3.674841807859462*^9, 3.674846103534198*^9, 
   3.674899687290504*^9, {3.6749010772282143`*^9, 3.674901098132348*^9}, 
   3.6749027177422485`*^9, 3.6749033109360514`*^9, 3.674907396040638*^9}],

Cell[BoxData["\<\"The explicit form of the integrand is listed in the \
variable 'Integrand'\"\>"], "Print",
 CellChangeTimes->{{3.674565031621353*^9, 3.674565064584365*^9}, 
   3.674580630048698*^9, 3.674841807859462*^9, 3.674846103534198*^9, 
   3.674899687290504*^9, {3.6749010772282143`*^9, 3.674901098132348*^9}, 
   3.6749027177422485`*^9, 3.6749033109360514`*^9, 3.674907396040638*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Number of spurious terms: \"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\", listed in the variable 'SpuriousBasis'\"\>"}],
  SequenceForm[
  "Number of spurious terms: ", 2, ", listed in the variable 'SpuriousBasis'"],
  Editable->False]], "Print",
 CellChangeTimes->{{3.674565031621353*^9, 3.674565064584365*^9}, 
   3.674580630048698*^9, 3.674841807859462*^9, 3.674846103534198*^9, 
   3.674899687290504*^9, {3.6749010772282143`*^9, 3.674901098132348*^9}, 
   3.6749027177422485`*^9, 3.6749033109360514`*^9, 3.674907396040638*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Number of non-spurious terms: \"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\", listed in the variable 'NSpuriousBasis'\"\>"}],
  SequenceForm[
  "Number of non-spurious terms: ", 3, 
   ", listed in the variable 'NSpuriousBasis'"],
  Editable->False]], "Print",
 CellChangeTimes->{{3.674565031621353*^9, 3.674565064584365*^9}, 
   3.674580630048698*^9, 3.674841807859462*^9, 3.674846103534198*^9, 
   3.674899687290504*^9, {3.6749010772282143`*^9, 3.674901098132348*^9}, 
   3.6749027177422485`*^9, 3.6749033109360514`*^9, 3.674907396056238*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Time used: \"\>", "\[InvisibleSpace]", "0.15600000000000058`", 
   "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm["Time used: ", 0.15600000000000058`, " seconds"],
  Editable->False]], "Print",
 CellChangeTimes->{{3.674565031621353*^9, 3.674565064584365*^9}, 
   3.674580630048698*^9, 3.674841807859462*^9, 3.674846103534198*^9, 
   3.674899687290504*^9, {3.6749010772282143`*^9, 3.674901098132348*^9}, 
   3.6749027177422485`*^9, 3.6749033109360514`*^9, 3.674907396056238*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"cc", "[", 
   RowBox[{"0", ",", "0"}], "]"}], "+", 
  RowBox[{"\[Mu]11", " ", 
   RowBox[{"cc", "[", 
    RowBox[{"0", ",", "1"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["\[Mu]11", "2"], " ", 
   RowBox[{"cc", "[", 
    RowBox[{"0", ",", "2"}], "]"}]}], "+", 
  RowBox[{"x14", " ", 
   RowBox[{"cc", "[", 
    RowBox[{"1", ",", "0"}], "]"}]}], "+", 
  RowBox[{"x14", " ", "\[Mu]11", " ", 
   RowBox[{"cc", "[", 
    RowBox[{"1", ",", "1"}], "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.674316105026455*^9, 3.6743162108419333`*^9, 3.6743162782811656`*^9, 
   3.674403677746464*^9, 3.674403997751315*^9, 3.6744741921573877`*^9, 
   3.674496024106584*^9, {3.674564950904129*^9, 3.6745650000756445`*^9}, {
   3.6745650333529644`*^9, 3.674565064787166*^9}, 3.674580630251499*^9, 
   3.6748418080622625`*^9, 3.674846103736999*^9, 3.6748996881017094`*^9, {
   3.6749010776026163`*^9, 3.6749010983351493`*^9}, 3.67490271789825*^9, 
   3.674903311731656*^9, 3.674907396056238*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{"ISP", "\[IndentingNewLine]", "Delta4", "\[IndentingNewLine]", 
 RowBox[{"cutEqFor4", " ", "=", "CutEqnISP"}]}], "Input",
 CellChangeTimes->{{3.674901326034209*^9, 3.6749013262994103`*^9}, {
  3.6749033251789427`*^9, 3.674903332947792*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"x14", ",", "\[Mu]11"}], "}"}]], "Output",
 CellChangeTimes->{3.6749013267518134`*^9, 3.6749027236390867`*^9, 
  3.6749033343674016`*^9, 3.674907400283865*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"cc", "[", 
   RowBox[{"0", ",", "0"}], "]"}], "+", 
  RowBox[{"\[Mu]11", " ", 
   RowBox[{"cc", "[", 
    RowBox[{"0", ",", "1"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["\[Mu]11", "2"], " ", 
   RowBox[{"cc", "[", 
    RowBox[{"0", ",", "2"}], "]"}]}], "+", 
  RowBox[{"x14", " ", 
   RowBox[{"cc", "[", 
    RowBox[{"1", ",", "0"}], "]"}]}], "+", 
  RowBox[{"x14", " ", "\[Mu]11", " ", 
   RowBox[{"cc", "[", 
    RowBox[{"1", ",", "1"}], "]"}]}]}]], "Output",
 CellChangeTimes->{3.6749013267518134`*^9, 3.6749027236390867`*^9, 
  3.6749033343674016`*^9, 3.674907400299465*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"4", " ", 
    SuperscriptBox["t", "2"], " ", "\[Mu]11"}], "+", 
   RowBox[{"s", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["t", "2"]}], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["x14", "2"]}], "+", 
      RowBox[{"4", " ", "t", " ", "\[Mu]11"}]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.6749013267518134`*^9, 3.6749027236390867`*^9, 
  3.6749033343674016`*^9, 3.674907400299465*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "Here", " ", "we", " ", "have", " ", "an", " ", "acceess", " ", "to", " ",
      "the", " ", "internal", " ", "expression", " ", "of", " ", "RSP"}], ",",
     " ", 
    RowBox[{
     RowBox[{"where", " ", "\[IndentingNewLine]", "xij"}], " ", ":=", " ", 
     RowBox[{"li", ".", "ej", "."}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"RSPSolution", "\[IndentingNewLine]", "ISP"}]}]], "Input",
 CellChangeTimes->{{3.6742312547571187`*^9, 3.67423139841844*^9}, {
   3.674231629580721*^9, 3.674231653994878*^9}, 3.6742317237429247`*^9, {
   3.674231905109688*^9, 3.6742319153433533`*^9}, {3.674231965123272*^9, 
   3.6742320442157793`*^9}, {3.6742322459406724`*^9, 3.674232296422596*^9}, {
   3.6742323273731947`*^9, 3.674232373081487*^9}, {3.6742324632968655`*^9, 
   3.6742324725477247`*^9}, {3.674232588191266*^9, 3.674232590671682*^9}, {
   3.674242290363204*^9, 3.674242291018408*^9}, {3.674242325182627*^9, 
   3.674242389252238*^9}, {3.674242554348096*^9, 3.6742425647221622`*^9}, {
   3.674243608384453*^9, 3.6742436137196865`*^9}, {3.674246338760755*^9, 
   3.674246368135743*^9}, {3.6742484029035864`*^9, 3.6742484125912485`*^9}, {
   3.674404318567372*^9, 3.6744043485039635`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"x11", "\[Rule]", "0"}], ",", 
   RowBox[{"x12", "\[Rule]", 
    RowBox[{"-", 
     FractionBox["s", "2"]}]}], ",", 
   RowBox[{"x13", "\[Rule]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6743159549823866`*^9, 3.6744042555117674`*^9, {3.6744044093131533`*^9, 
   3.674404412869976*^9}, 3.674899707711035*^9, 3.674902737491976*^9, 
   3.6749033509347076`*^9, 3.674907403481886*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"x14", ",", "\[Mu]11"}], "}"}]], "Output",
 CellChangeTimes->{
  3.6743159549823866`*^9, 3.6744042555117674`*^9, {3.6744044093131533`*^9, 
   3.674404412869976*^9}, 3.674899707711035*^9, 3.674902737491976*^9, 
   3.6749033509347076`*^9, 3.6749074034974856`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Here", " ", "we", " ", "can", " ", "access", " ", "to", " ", "the", " ", 
    "basis", " ", "for", " ", "physical", " ", 
    RowBox[{"timespace", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"SpacetimeBasis", "\[IndentingNewLine]", 
   RowBox[{"SpacetimeBasis", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.674475016310671*^9, 3.6744750620033636`*^9}, {
  3.674475536059202*^9, 3.674475539756426*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"p1", ",", "p2", ",", "p4", ",", "\[Omega]1"}], "}"}]], "Output",
 CellChangeTimes->{3.674475004345394*^9, 3.6744755406144314`*^9, 
  3.6748418148639064`*^9, 3.6749027411891994`*^9, 3.6749033544291306`*^9, 
  3.674907407151822*^9}],

Cell[BoxData["p2"], "Output",
 CellChangeTimes->{3.674475004345394*^9, 3.6744755406144314`*^9, 
  3.6748418148639064`*^9, 3.6749027411891994`*^9, 3.6749033544291306`*^9, 
  3.6749074071674223`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"He", " ", "already", " ", "made", " ", "it"}], "..."}], " ", 
   "*)"}], "\[IndentingNewLine]", "ScalarProductRules"}]], "Input",
 CellChangeTimes->{{3.674477227172443*^9, 3.6744772323984766`*^9}, 
   3.6744775573641596`*^9, {3.6744776716504917`*^9, 3.6744776815253553`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SuperscriptBox["l1", "2"], "\[Rule]", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{
        SuperscriptBox["t", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x11", "+", "x12"}], ")"}], "2"]}], "+", 
       RowBox[{"2", " ", "s", " ", "t", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x11", "2"], "-", 
          RowBox[{"x12", " ", "x13"}], "+", 
          RowBox[{"x11", " ", 
           RowBox[{"(", 
            RowBox[{"x12", "+", "x13"}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["s", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x11", "2"], "+", 
          RowBox[{"2", " ", "x11", " ", "x13"}], "+", 
          SuperscriptBox["x13", "2"], "-", 
          SuperscriptBox["x14", "2"]}], ")"}]}]}], 
      RowBox[{"s", " ", "t", " ", 
       RowBox[{"(", 
        RowBox[{"s", "+", "t"}], ")"}]}]], "-", "\[Mu]11"}]}], ",", 
   RowBox[{
    RowBox[{"l1", " ", "p1"}], "\[Rule]", "x11"}], ",", 
   RowBox[{
    RowBox[{"l1", " ", "p2"}], "\[Rule]", "x12"}], ",", 
   RowBox[{
    RowBox[{"l1", " ", "p4"}], "\[Rule]", "x13"}], ",", 
   RowBox[{
    RowBox[{"l1", " ", "\[Omega]1"}], "\[Rule]", "x14"}], ",", 
   RowBox[{
    RowBox[{"l1", " ", "p3"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", "x11"}], "-", "x12", "-", "x13"}]}], ",", 
   RowBox[{
    SuperscriptBox["p1", "2"], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"p1", " ", "p2"}], "\[Rule]", 
    FractionBox["s", "2"]}], ",", 
   RowBox[{
    RowBox[{"p1", " ", "p4"}], "\[Rule]", 
    FractionBox["t", "2"]}], ",", 
   RowBox[{
    RowBox[{"p1", " ", "\[Omega]1"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"p1", " ", "p3"}], "\[Rule]", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "s"}], "-", "t"}], ")"}]}]}], ",", 
   RowBox[{
    SuperscriptBox["p2", "2"], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"p2", " ", "p4"}], "\[Rule]", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "s"}], "-", "t"}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{"p2", " ", "\[Omega]1"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"p2", " ", "p3"}], "\[Rule]", 
    FractionBox["t", "2"]}], ",", 
   RowBox[{
    SuperscriptBox["p4", "2"], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"p4", " ", "\[Omega]1"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"p3", " ", "p4"}], "\[Rule]", 
    FractionBox["s", "2"]}], ",", 
   RowBox[{
    SuperscriptBox["\[Omega]1", "2"], "\[Rule]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"t", " ", 
       RowBox[{"(", 
        RowBox[{"s", "+", "t"}], ")"}]}], "s"]}]}], ",", 
   RowBox[{
    RowBox[{"p3", " ", "\[Omega]1"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    SuperscriptBox["p3", "2"], "\[Rule]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6744772329756804`*^9, 3.6744775583157654`*^9, 
  3.6745806418482866`*^9, 3.6748418175159235`*^9, 3.674841908526907*^9, 
  3.6749027441688185`*^9, 3.674907409679038*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"l1", " ", "p1"}], "  ", "+", " ", 
     RowBox[{"l1", "^", "2"}]}], " ", "/.", " ", "ScalarProductRules"}], " ", 
   "/.", " ", "RSPSolution"}], " ", "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.6744759865900908`*^9, 3.6744760025801926`*^9}, {
  3.6744762386565065`*^9, 3.6744762588898363`*^9}, {3.674476805345739*^9, 
  3.674476814627798*^9}, {3.6744775706242447`*^9, 3.6744776435547123`*^9}, {
  3.6745651412744565`*^9, 3.6745651642534037`*^9}, {3.6745653498945937`*^9, 
  3.6745653510490007`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"s", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["t", "2"], "-", 
      RowBox[{"4", " ", 
       SuperscriptBox["x14", "2"]}]}], ")"}]}], 
   RowBox[{"4", " ", "t", " ", 
    RowBox[{"(", 
     RowBox[{"s", "+", "t"}], ")"}]}]], "-", "\[Mu]11"}]], "Output",
 CellChangeTimes->{{3.6744775878623548`*^9, 3.67447764478712*^9}, 
   3.6745651659382143`*^9, 3.6745653564466352`*^9, 3.6745806458731127`*^9, 
   3.6749027510796623`*^9, 3.674907413781864*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"This", " ", "includes", " ", "polarization", " ", 
    RowBox[{"vector", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"rewritingRuleForPolarization", " ", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"l1", " ", "aVector_"}], " ", "\[Rule]", " ", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ToExpression", "[", 
         RowBox[{"\"\<x1\>\"", "  ", "<>", " ", 
          RowBox[{"ToString", "[", "j", "]"}]}], "]"}], " ", 
        RowBox[{"SpacetimeBasis", "[", 
         RowBox[{"[", "j", "]"}], "]"}], "  ", "aVector"}], " ", ",", " ", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}]}], 
    "\[IndentingNewLine]", "}"}], " "}]}]], "Input",
 CellChangeTimes->{{3.674566350337502*^9, 3.674566360275403*^9}, {
  3.674566522604848*^9, 3.6745665276596045`*^9}, {3.6745665582533617`*^9, 
  3.6745666468186045`*^9}, {3.6745670713043766`*^9, 3.674567077029687*^9}, {
  3.6745807644494724`*^9, 3.674580778754764*^9}, {3.674821924173867*^9, 
  3.6748219424729023`*^9}, {3.674821974531313*^9, 3.674821986543467*^9}, {
  3.6748467550879745`*^9, 3.6748468125743427`*^9}, {3.6748500989538093`*^9, 
  3.674850131370817*^9}, {3.6748504698929873`*^9, 3.674850513573267*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"l1", " ", "aVector_"}], "\[Rule]", 
   RowBox[{
    RowBox[{"aVector", " ", "p1", " ", "x11"}], "+", 
    RowBox[{"aVector", " ", "p2", " ", "x12"}], "+", 
    RowBox[{"aVector", " ", "p4", " ", "x13"}], "+", 
    RowBox[{"aVector", " ", "x14", " ", "\[Omega]1"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6745670785429153`*^9, 3.674580650818344*^9, 3.674580780189973*^9, 
   3.674841822398755*^9, 3.6748467762417097`*^9, {3.6748468078475122`*^9, 
   3.6748468129487453`*^9}, {3.674850107799066*^9, 3.6748501322132225`*^9}, 
   3.6748504535908823`*^9, {3.6748505075828285`*^9, 3.674850514509273*^9}, 
   3.6748997663518105`*^9, 3.6749027548080864`*^9, 3.674905521111419*^9, 
   3.6749074221123176`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Is", " ", "there", " ", "any", " ", "generic", " ", "way", " ", "to", " ",
     "use", " ", 
    RowBox[{"\"\<forall\>\"", "?", " ", "\[IndentingNewLine]", "ToString"}], 
    " ", "function", " ", "does", " ", "not", " ", "work", " ", "how", " ", 
    "I", " ", "have", " ", 
    RowBox[{"expected", "."}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"a1", " ", "p1"}], " ", "\[Rule]", " ", "a1_p1"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a1", " ", "p2"}], " ", "\[Rule]", " ", "a1_p2"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a1", " ", "p4"}], " ", "\[Rule]", " ", "a1_p4"}], ",", " ", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a1", " ", "\[Omega]1"}], " ", "\[Rule]", " ", 
      "a1_\[Omega]1"}]}], "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]",
    "*)"}], " ", "\[IndentingNewLine]", 
  RowBox[{"innerProductRule", " ", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"\"\<a\>\"", " ", "<>", " ", 
            RowBox[{"ToString", "[", "i", "]"}]}], "]"}], "  ", 
          RowBox[{"SpacetimeBasis", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], " ", "\[Rule]", " ", 
         RowBox[{"\"\<a\>\"", "<>", " ", 
          RowBox[{"ToString", "[", "i", "]"}], "<>", " ", "\"\<_\>\"", "<>", 
          " ", 
          RowBox[{"ToString", "[", 
           RowBox[{"SpacetimeBasis", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6748506774523177`*^9, 3.67485077616975*^9}, {
   3.6748508138283916`*^9, 3.6748508355437307`*^9}, {3.6748510610743766`*^9, 
   3.6748510829925175`*^9}, {3.674906732599585*^9, 3.6749067379660196`*^9}, 
   3.674906805249251*^9, {3.674906841940686*^9, 3.6749068440934997`*^9}, {
   3.6749069975672836`*^9, 3.6749070566916623`*^9}, {3.6749070897950745`*^9, 
   3.674907374996103*^9}, {3.674907804845171*^9, 3.674907840382199*^9}, {
   3.6749079488652945`*^9, 3.6749079578665524`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"a1", " ", "p1"}], "\[Rule]", "\<\"a1_p1\"\>"}], ",", 
   RowBox[{
    RowBox[{"a2", " ", "p1"}], "\[Rule]", "\<\"a2_p1\"\>"}], ",", 
   RowBox[{
    RowBox[{"a3", " ", "p1"}], "\[Rule]", "\<\"a3_p1\"\>"}], ",", 
   RowBox[{
    RowBox[{"a4", " ", "p1"}], "\[Rule]", "\<\"a4_p1\"\>"}], ",", 
   RowBox[{
    RowBox[{"a1", " ", "p2"}], "\[Rule]", "\<\"a1_p2\"\>"}], ",", 
   RowBox[{
    RowBox[{"a2", " ", "p2"}], "\[Rule]", "\<\"a2_p2\"\>"}], ",", 
   RowBox[{
    RowBox[{"a3", " ", "p2"}], "\[Rule]", "\<\"a3_p2\"\>"}], ",", 
   RowBox[{
    RowBox[{"a4", " ", "p2"}], "\[Rule]", "\<\"a4_p2\"\>"}], ",", 
   RowBox[{
    RowBox[{"a1", " ", "p4"}], "\[Rule]", "\<\"a1_p4\"\>"}], ",", 
   RowBox[{
    RowBox[{"a2", " ", "p4"}], "\[Rule]", "\<\"a2_p4\"\>"}], ",", 
   RowBox[{
    RowBox[{"a3", " ", "p4"}], "\[Rule]", "\<\"a3_p4\"\>"}], ",", 
   RowBox[{
    RowBox[{"a4", " ", "p4"}], "\[Rule]", "\<\"a4_p4\"\>"}], ",", 
   RowBox[{
    RowBox[{"a1", " ", "\[Omega]1"}], "\[Rule]", "\<\"a1_\[Omega]1\"\>"}], 
   ",", 
   RowBox[{
    RowBox[{"a2", " ", "\[Omega]1"}], "\[Rule]", "\<\"a2_\[Omega]1\"\>"}], 
   ",", 
   RowBox[{
    RowBox[{"a3", " ", "\[Omega]1"}], "\[Rule]", "\<\"a3_\[Omega]1\"\>"}], 
   ",", 
   RowBox[{
    RowBox[{"a4", " ", "\[Omega]1"}], "\[Rule]", "\<\"a4_\[Omega]1\"\>"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.6749072590093594`*^9, 3.6749072894763546`*^9}, {
   3.6749073220025635`*^9, 3.674907376322111*^9}, 3.674907425918742*^9, {
   3.6749078127388215`*^9, 3.674907841177804*^9}, 3.6749079588493586`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"(*", " ", 
   RowBox[{"Consider", " ", "the", " ", "following", " ", "numerator", " ", 
    RowBox[{"function", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"l1", " ", "p2"}], " ", "/.", " ", "ScalarProductRules"}], "/.", 
   "  ", "RSPSolution", " "}]}]], "Input",
 CellChangeTimes->{{3.6749007123106747`*^9, 3.6749007528085346`*^9}, {
   3.6749007927603903`*^9, 3.6749008190777593`*^9}, {3.674901450335806*^9, 
   3.6749014662479076`*^9}, 3.674901642070941*^9, {3.674901678637575*^9, 
   3.674901685954022*^9}, {3.674903662531105*^9, 3.6749037153530436`*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox["s", "2"]}]], "Output",
 CellChangeTimes->{{3.6749007309995947`*^9, 3.6749007541033425`*^9}, 
   3.6749008200605655`*^9, {3.674901467620716*^9, 3.674901492393675*^9}, 
   3.6749016428509455`*^9, 3.6749016869836283`*^9, 3.6749027628889384`*^9, {
   3.674903665573125*^9, 3.67490371633585*^9}, 3.6749074344987974`*^9, 
   3.6749078486502523`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "Compare", " ", "the", " ", "quadropole", " ", "cut", " ", "and", " ", 
    "numerator", " ", "function", " ", "on", " ", "the", " ", "cut"}], ",", 
   " ", 
   RowBox[{"term", " ", "by", " ", 
    RowBox[{"term", "."}]}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.674903157056665*^9, 3.67490319215689*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{"Delta4", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numeratorFunc", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"l1", " ", "p2"}], " ", "/.", " ", "ScalarProductRules"}], "/.", 
    "  ", "RSPSolution"}]}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
   "c00", ",", " ", "c01", ",", " ", "c02", ",", " ", "c10", ",", " ", 
    "c11"}], "}"}], " ", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"numeratorFunc", ",", " ", "x14", ",", " ", "0"}], "]"}], ",", 
    RowBox[{"Coefficient", "[", 
     RowBox[{"numeratorFunc", ",", " ", "\[Mu]11", ",", " ", "1"}], "]"}], 
    ",", 
    RowBox[{"Coefficient", "[", 
     RowBox[{"numeratorFunc", ",", " ", "\[Mu]11", ",", " ", "2"}], "]"}], 
    ",", " ", 
    RowBox[{"Coefficient", "[", 
     RowBox[{"numeratorFunc", ",", " ", "x14", ",", "1"}], "]"}], ",", " ", 
    RowBox[{"Coefficient", "[", 
     RowBox[{"numeratorFunc", ",", " ", 
      RowBox[{"\[Mu]11", " ", "x14"}], ",", " ", "1"}], "]"}]}], 
   "}"}]}]}], "Input",
 CellChangeTimes->{{3.674901692552864*^9, 3.674901759243292*^9}, {
   3.674902218089033*^9, 3.6749022752789993`*^9}, {3.6749025195453653`*^9, 
   3.674902634923705*^9}, 3.6749039684646664`*^9, 3.6749043378750343`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"cc", "[", 
   RowBox[{"0", ",", "0"}], "]"}], "+", 
  RowBox[{"\[Mu]11", " ", 
   RowBox[{"cc", "[", 
    RowBox[{"0", ",", "1"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["\[Mu]11", "2"], " ", 
   RowBox[{"cc", "[", 
    RowBox[{"0", ",", "2"}], "]"}]}], "+", 
  RowBox[{"x14", " ", 
   RowBox[{"cc", "[", 
    RowBox[{"1", ",", "0"}], "]"}]}], "+", 
  RowBox[{"x14", " ", "\[Mu]11", " ", 
   RowBox[{"cc", "[", 
    RowBox[{"1", ",", "1"}], "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.6749017167798195`*^9, 3.6749017602416983`*^9, {3.674902247027219*^9, 
   3.6749022757002025`*^9}, 3.6749025213237767`*^9, 3.67490263567251*^9, 
   3.6749027687077756`*^9, 3.674903969915476*^9, 3.674904340542651*^9, 
   3.674907436838812*^9, 3.6749078638447495`*^9}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox["s", "2"]}]], "Output",
 CellChangeTimes->{
  3.6749017167798195`*^9, 3.6749017602416983`*^9, {3.674902247027219*^9, 
   3.6749022757002025`*^9}, 3.6749025213237767`*^9, 3.67490263567251*^9, 
   3.6749027687077756`*^9, 3.674903969915476*^9, 3.674904340542651*^9, 
   3.674907436838812*^9, 3.6749078638447495`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox["s", "2"]}], ",", "0", ",", "0", ",", "0", ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.6749017167798195`*^9, 3.6749017602416983`*^9, {3.674902247027219*^9, 
   3.6749022757002025`*^9}, 3.6749025213237767`*^9, 3.67490263567251*^9, 
   3.6749027687077756`*^9, 3.674903969915476*^9, 3.674904340542651*^9, 
   3.674907436838812*^9, 3.6749078638447495`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Next", " ", 
   RowBox[{"example", "."}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.674905746236462*^9, 3.6749057564857283`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"l1", " ", "p2"}], " ", "+", " ", 
   RowBox[{"l1", " ", "a1"}], " ", "+", " ", 
   RowBox[{"p1", " ", "p1"}]}], " ", "/.", " ", 
  "ScalarProductRules"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"l1", " ", "p2"}], " ", "+", " ", 
    RowBox[{"l1", " ", "a1"}], " ", "+", " ", 
    RowBox[{"p1", " ", "p1"}]}], " ", "/.", " ", "ScalarProductRules"}], " ", 
  "/.", " ", "rewritingRuleForPolarization"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"l1", " ", "p2"}], " ", "+", " ", 
     RowBox[{"l1", " ", "a1"}], " ", "+", " ", 
     RowBox[{"p1", " ", "p1"}]}], " ", "/.", " ", "ScalarProductRules"}], " ",
    "/.", " ", "rewritingRuleForPolarization"}], " ", "/.", " ", 
  "innerProductRule"}]}], "Input",
 CellChangeTimes->{{3.6748417949269786`*^9, 3.6748417973293943`*^9}, {
   3.6748996507238693`*^9, 3.674899664373957*^9}, 3.6749006832476883`*^9, 
   3.67490484891871*^9, {3.6749079050914135`*^9, 3.6749079320483866`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"a1", " ", "l1"}], "+", "x12"}]], "Output",
 CellChangeTimes->{
  3.6745809915401278`*^9, {3.674841800324613*^9, 3.674841825456374*^9}, 
   3.674899666791973*^9, 3.6748997782546873`*^9, 3.674900688598523*^9, 
   3.674904886624152*^9, 3.6749074403800344`*^9, 3.6749074731558447`*^9, {
   3.674907914014671*^9, 3.674907933779998*^9}, 3.67490797003463*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"a1", " ", "p1", " ", "x11"}], "+", "x12", "+", 
  RowBox[{"a1", " ", "p2", " ", "x12"}], "+", 
  RowBox[{"a1", " ", "p4", " ", "x13"}], "+", 
  RowBox[{"a1", " ", "x14", " ", "\[Omega]1"}]}]], "Output",
 CellChangeTimes->{
  3.6745809915401278`*^9, {3.674841800324613*^9, 3.674841825456374*^9}, 
   3.674899666791973*^9, 3.6748997782546873`*^9, 3.674900688598523*^9, 
   3.674904886624152*^9, 3.6749074403800344`*^9, 3.6749074731558447`*^9, {
   3.674907914014671*^9, 3.674907933779998*^9}, 3.67490797003463*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\<\"a1_p1\"\>", " ", "x11"}], "+", "x12", "+", 
  RowBox[{"\<\"a1_p2\"\>", " ", "x12"}], "+", 
  RowBox[{"\<\"a1_p4\"\>", " ", "x13"}], "+", 
  RowBox[{"\<\"a1_\[Omega]1\"\>", " ", "x14"}]}]], "Output",
 CellChangeTimes->{
  3.6745809915401278`*^9, {3.674841800324613*^9, 3.674841825456374*^9}, 
   3.674899666791973*^9, 3.6748997782546873`*^9, 3.674900688598523*^9, 
   3.674904886624152*^9, 3.6749074403800344`*^9, 3.6749074731558447`*^9, {
   3.674907914014671*^9, 3.674907933779998*^9}, 3.67490797003463*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"numeratorFunc1", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"l1", " ", "p2"}], " ", "+", " ", 
       RowBox[{"l1", " ", "a1"}], " ", "+", " ", 
       RowBox[{"p1", " ", "p1"}]}], " ", "/.", " ", "ScalarProductRules"}], 
     " ", "/.", "rewritingRuleForPolarization"}], "/.", "innerProductRule"}], 
   " ", "/.", "RSPSolution"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
   "c00", ",", " ", "c01", ",", " ", "c02", ",", " ", "c10", ",", " ", 
    "c11"}], "}"}], " ", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"numeratorFunc1", ",", " ", "x14", ",", " ", "0"}], "]"}], ",", 
    RowBox[{"Coefficient", "[", 
     RowBox[{"numeratorFunc1", ",", " ", "\[Mu]11", ",", " ", "1"}], "]"}], 
    ",", 
    RowBox[{"Coefficient", "[", 
     RowBox[{"numeratorFunc1", ",", " ", "\[Mu]11", ",", " ", "2"}], "]"}], 
    ",", " ", 
    RowBox[{"Coefficient", "[", 
     RowBox[{"numeratorFunc1", ",", " ", "x14", ",", "1"}], "]"}], ",", " ", 
    RowBox[{"Coefficient", "[", 
     RowBox[{"numeratorFunc1", ",", " ", 
      RowBox[{"\[Mu]11", " ", "x14"}], ",", " ", "1"}], "]"}]}], 
   "}"}]}]}], "Input",
 CellChangeTimes->{
  3.6748418305420065`*^9, 3.674847550630674*^9, 3.6748499593953147`*^9, {
   3.6748501411208797`*^9, 3.6748501431176925`*^9}, 3.674850537332219*^9, {
   3.674850787651424*^9, 3.674850790880645*^9}, 3.6748998012492347`*^9, {
   3.6749048760628843`*^9, 3.674904878356099*^9}, {3.6749052267375317`*^9, 
   3.6749052399196167`*^9}, {3.6749054738899164`*^9, 3.674905498506874*^9}, {
   3.674905542483556*^9, 3.6749055671941147`*^9}, {3.6749056699987736`*^9, 
   3.6749056846784678`*^9}, 3.6749078706931934`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["s", "2"]}], "-", 
  FractionBox[
   RowBox[{"\<\"a1_p2\"\>", " ", "s"}], "2"], "+", 
  RowBox[{"\<\"a1_\[Omega]1\"\>", " ", "x14"}]}]], "Output",
 CellChangeTimes->{
  3.674581009417843*^9, 3.674841831665214*^9, 3.6748475514574795`*^9, 
   3.6748476146534843`*^9, {3.6748477363498645`*^9, 3.6748477635564384`*^9}, 
   3.6748487641468525`*^9, 3.6748488704927344`*^9, 3.674848907886174*^9, 
   3.6748489517692556`*^9, 3.674849785750602*^9, 3.674849918959855*^9, 
   3.674849959894518*^9, {3.674850121152752*^9, 3.674850143663696*^9}, 
   3.6748505380030236`*^9, 3.674850791847851*^9, 3.6748998027468443`*^9, 
   3.6749048803061113`*^9, 3.6749052346155825`*^9, 3.674905502999703*^9, {
   3.674905533560299*^9, 3.6749055678493185`*^9}, {3.6749056718395853`*^9, 
   3.6749056862852783`*^9}, 3.6749074417372437`*^9, 3.674907872814807*^9, 
   3.6749083120824223`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     FractionBox["s", "2"]}], "-", 
    FractionBox[
     RowBox[{"\<\"a1_p2\"\>", " ", "s"}], "2"]}], ",", "0", ",", "0", 
   ",", "\<\"a1_\[Omega]1\"\>", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.674581009417843*^9, 3.674841831665214*^9, 3.6748475514574795`*^9, 
   3.6748476146534843`*^9, {3.6748477363498645`*^9, 3.6748477635564384`*^9}, 
   3.6748487641468525`*^9, 3.6748488704927344`*^9, 3.674848907886174*^9, 
   3.6748489517692556`*^9, 3.674849785750602*^9, 3.674849918959855*^9, 
   3.674849959894518*^9, {3.674850121152752*^9, 3.674850143663696*^9}, 
   3.6748505380030236`*^9, 3.674850791847851*^9, 3.6748998027468443`*^9, 
   3.6749048803061113`*^9, 3.6749052346155825`*^9, 3.674905502999703*^9, {
   3.674905533560299*^9, 3.6749055678493185`*^9}, {3.6749056718395853`*^9, 
   3.6749056862852783`*^9}, 3.6749074417372437`*^9, 3.674907872814807*^9, 
   3.6749083120824223`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"l1", " ", "p2"}], " ", "+", " ", 
    RowBox[{"l1", " ", "a1"}], " ", "+", " ", 
    RowBox[{"p1", " ", "p1"}]}], " ", "/.", " ", "ScalarProductRules"}], " ", 
  "/.", "rewritingRuleForPolarization", " "}]], "Input",
 CellChangeTimes->{{3.674581395754319*^9, 3.674581406455988*^9}, {
   3.674841879853923*^9, 3.6748418862499638`*^9}, 3.6748508759635897`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"a1", " ", "p1", " ", "x11"}], "+", "x12", "+", 
  RowBox[{"a1", " ", "p2", " ", "x12"}], "+", 
  RowBox[{"a1", " ", "p4", " ", "x13"}], "+", 
  RowBox[{"a1", " ", "x14", " ", "\[Omega]1"}]}]], "Output",
 CellChangeTimes->{3.674581407813196*^9, 3.6748508869616604`*^9, 
  3.6749089349788156`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"numeratorFunc2", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"l1", " ", "p2"}], " ", "+", " ", 
       RowBox[{"l1", " ", "a1"}], " ", "+", " ", 
       RowBox[{"p1", " ", "p1"}]}], " ", "/.", " ", "ScalarProductRules"}], 
     " ", "/.", "rewritingRuleForPolarization"}], "  ", "/.", " ", 
    "innerProductRule"}], "/.", " ", "RSPSolution"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
   "c00", ",", " ", "c01", ",", " ", "c02", ",", " ", "c10", ",", " ", 
    "c11"}], "}"}], " ", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"numeratorFunc2", ",", " ", "x14", ",", " ", "0"}], "]"}], ",", 
    RowBox[{"Coefficient", "[", 
     RowBox[{"numeratorFunc2", ",", " ", "\[Mu]11", ",", " ", "1"}], "]"}], 
    ",", 
    RowBox[{"Coefficient", "[", 
     RowBox[{"numeratorFunc2", ",", " ", "\[Mu]11", ",", " ", "2"}], "]"}], 
    ",", " ", 
    RowBox[{"Coefficient", "[", 
     RowBox[{"numeratorFunc2", ",", " ", "x14", ",", "1"}], "]"}], ",", " ", 
    RowBox[{"Coefficient", "[", 
     RowBox[{"numeratorFunc2", ",", " ", 
      RowBox[{"\[Mu]11", " ", "x14"}], ",", " ", "1"}], "]"}]}], 
   "}"}]}]}], "Input",
 CellChangeTimes->{{3.6745667595470953`*^9, 3.6745668193122272`*^9}, {
   3.6745808027165174`*^9, 3.6745808054153347`*^9}, {3.6745814257845116`*^9, 
   3.674581433490961*^9}, {3.674841881226732*^9, 3.674841892786406*^9}, 
   3.6748420101927586`*^9, {3.6748508951829133`*^9, 3.6748508996445417`*^9}, {
   3.6749063362634444`*^9, 3.674906359788395*^9}, 3.6749089307043877`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["s", "2"]}], "-", 
  FractionBox[
   RowBox[{"\<\"a1_p2\"\>", " ", "s"}], "2"], "+", 
  RowBox[{"\<\"a1_\[Omega]1\"\>", " ", "x14"}]}]], "Output",
 CellChangeTimes->{
  3.674567082645795*^9, 3.6745806556231747`*^9, {3.6745807847608023`*^9, 
   3.6745808065541425`*^9}, 3.674581435628175*^9, 3.6748418944244165`*^9, 
   3.6748420119399695`*^9, 3.674850901360553*^9, 3.674906360693201*^9, 
   3.6749089414219637`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     FractionBox["s", "2"]}], "-", 
    FractionBox[
     RowBox[{"\<\"a1_p2\"\>", " ", "s"}], "2"]}], ",", "0", ",", "0", 
   ",", "\<\"a1_\[Omega]1\"\>", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.674567082645795*^9, 3.6745806556231747`*^9, {3.6745807847608023`*^9, 
   3.6745808065541425`*^9}, 3.674581435628175*^9, 3.6748418944244165`*^9, 
   3.6748420119399695`*^9, 3.674850901360553*^9, 3.674906360693201*^9, 
   3.6749089414531636`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"rank", " ", "4", " ", "example"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"l1", " ", "a1"}], ")"}], " ", "*", " ", 
   RowBox[{"(", 
    RowBox[{"l1", " ", "a2"}], ")"}], " ", "*", " ", 
   RowBox[{"(", 
    RowBox[{"l1", " ", "a3"}], ")"}], " ", "*", 
   RowBox[{"(", 
    RowBox[{"l1", " ", "a4"}], ")"}], " "}]}]], "Input",
 CellChangeTimes->{{3.674844173380625*^9, 3.674844218574115*^9}, {
   3.674844271817256*^9, 3.6748442732524652`*^9}, {3.674899909841531*^9, 
   3.67489995810824*^9}, {3.674900638990205*^9, 3.6749006427030287`*^9}, 
   3.6749089512656264`*^9, {3.6749090077535887`*^9, 3.6749090103276052`*^9}}],

Cell[BoxData[
 RowBox[{"a1", " ", "a2", " ", "a3", " ", "a4", " ", 
  SuperscriptBox["l1", "4"]}]], "Output",
 CellChangeTimes->{3.674844275077677*^9, 3.6748999229300146`*^9, 
  3.6749063985078435`*^9, 3.6749089527944365`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Let", " ", "us", " ", "consider", " ", "term", " ", "by", " ", 
    RowBox[{"term", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"l1", " ", "a1"}], "/.", " ", "rewritingRuleForPolarization"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"l1", " ", "a1"}], "/.", " ", "rewritingRuleForPolarization"}], 
    " ", "/.", "innerProductRule"}], "\[IndentingNewLine]", 
   RowBox[{"l1a1", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"l1", " ", "a1"}], "/.", " ", "rewritingRuleForPolarization"}],
       " ", "/.", "innerProductRule"}], " ", "/.", 
     "RSPSolution"}]}]}]}]], "Input",
 CellChangeTimes->{{3.6749000890398793`*^9, 3.6749001046867795`*^9}, {
  3.6749001720324116`*^9, 3.6749002655394106`*^9}, {3.6749094705305552`*^9, 
  3.674909471622562*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"a1", " ", "p1", " ", "x11"}], "+", 
  RowBox[{"a1", " ", "p2", " ", "x12"}], "+", 
  RowBox[{"a1", " ", "p4", " ", "x13"}], "+", 
  RowBox[{"a1", " ", "x14", " ", "\[Omega]1"}]}]], "Output",
 CellChangeTimes->{{3.674900174013624*^9, 3.6749002664286165`*^9}, 
   3.674906402439069*^9, 3.6749089581764708`*^9, 3.674909473603775*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\<\"a1_p1\"\>", " ", "x11"}], "+", 
  RowBox[{"\<\"a1_p2\"\>", " ", "x12"}], "+", 
  RowBox[{"\<\"a1_p4\"\>", " ", "x13"}], "+", 
  RowBox[{"\<\"a1_\[Omega]1\"\>", " ", "x14"}]}]], "Output",
 CellChangeTimes->{{3.674900174013624*^9, 3.6749002664286165`*^9}, 
   3.674906402439069*^9, 3.6749089581764708`*^9, 3.6749094736193748`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"\<\"a1_p2\"\>", " ", "s"}], "2"]}], "+", 
  RowBox[{"\<\"a1_\[Omega]1\"\>", " ", "x14"}]}]], "Output",
 CellChangeTimes->{{3.674900174013624*^9, 3.6749002664286165`*^9}, 
   3.674906402439069*^9, 3.6749089581764708`*^9, 3.6749094736193748`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"{", 
   RowBox[{"l1a2", ",", " ", "l1a3", ",", " ", "l1a4"}], "}"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"l1", " ", "a2"}], ",", 
       RowBox[{"l1", " ", "a3"}], ",", " ", 
       RowBox[{"l1", " ", "a4"}]}], "}"}], " ", "/.", " ", 
     "rewritingRuleForPolarization"}], " ", "/.", "innerProductRule"}], " ", "/.",
    "RSPSolution"}]}], "\[IndentingNewLine]", "l1a1", "\[IndentingNewLine]", \
"l1a2", "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.674900286147143*^9, 3.6749003526347694`*^9}, 
   3.6749089653213167`*^9, {3.6749094423723745`*^9, 3.674909445414394*^9}, {
   3.6749094835410385`*^9, 3.674909487831066*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"\<\"a2_p2\"\>", " ", "s"}], "2"]}], "+", 
    RowBox[{"\<\"a2_\[Omega]1\"\>", " ", "x14"}]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"\<\"a3_p2\"\>", " ", "s"}], "2"]}], "+", 
    RowBox[{"\<\"a3_\[Omega]1\"\>", " ", "x14"}]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"\<\"a4_p2\"\>", " ", "s"}], "2"]}], "+", 
    RowBox[{"\<\"a4_\[Omega]1\"\>", " ", "x14"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.674900353336774*^9, 3.6749064060270915`*^9, {3.674908961468092*^9, 
   3.674908968035734*^9}, 3.6749094481756115`*^9, {3.674909480233817*^9, 
   3.674909488330269*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"\<\"a1_p2\"\>", " ", "s"}], "2"]}], "+", 
  RowBox[{"\<\"a1_\[Omega]1\"\>", " ", "x14"}]}]], "Output",
 CellChangeTimes->{
  3.674900353336774*^9, 3.6749064060270915`*^9, {3.674908961468092*^9, 
   3.674908968035734*^9}, 3.6749094481756115`*^9, {3.674909480233817*^9, 
   3.674909488330269*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"\<\"a2_p2\"\>", " ", "s"}], "2"]}], "+", 
  RowBox[{"\<\"a2_\[Omega]1\"\>", " ", "x14"}]}]], "Output",
 CellChangeTimes->{
  3.674900353336774*^9, 3.6749064060270915`*^9, {3.674908961468092*^9, 
   3.674908968035734*^9}, 3.6749094481756115`*^9, {3.674909480233817*^9, 
   3.674909488345869*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"numeratorFunc3", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
     "l1a1", " ", "*", " ", "l1a2", " ", "*", " ", "l1a3", " ", "*", " ", 
      "l1a4"}], " ", "//", " ", "Expand"}], " ", "//", "Simplify"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
   "c00", ",", " ", "c01", ",", " ", "c02", ",", " ", "c10", ",", " ", 
    "c11"}], "}"}], " ", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"numeratorFunc3", ",", " ", "x14", ",", " ", "0"}], "]"}], ",", 
    RowBox[{"Coefficient", "[", 
     RowBox[{"numeratorFunc3", ",", " ", "\[Mu]11", ",", " ", "1"}], "]"}], 
    ",", 
    RowBox[{"Coefficient", "[", 
     RowBox[{"numeratorFunc3", ",", " ", "\[Mu]11", ",", " ", "2"}], "]"}], 
    ",", " ", 
    RowBox[{"Coefficient", "[", 
     RowBox[{"numeratorFunc3", ",", " ", "x14", ",", "1"}], "]"}], ",", " ", 
    RowBox[{"Coefficient", "[", 
     RowBox[{"numeratorFunc3", ",", " ", 
      RowBox[{"\[Mu]11", " ", "x14"}], ",", " ", "1"}], "]"}]}], 
   "}"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.674900383678968*^9, 3.6749004488405857`*^9}, {
  3.674906376901705*^9, 3.674906413702341*^9}, {3.6749089907806797`*^9, 
  3.674909038516986*^9}, {3.6749093976156874`*^9, 3.6749094203918333`*^9}, {
  3.674909498751136*^9, 3.674909525271306*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "16"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"\<\"a1_p2\"\>", " ", "s"}], "-", 
    RowBox[{"2", " ", "\<\"a1_\[Omega]1\"\>", " ", "x14"}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"\<\"a2_p2\"\>", " ", "s"}], "-", 
    RowBox[{"2", " ", "\<\"a2_\[Omega]1\"\>", " ", "x14"}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"\<\"a3_p2\"\>", " ", "s"}], "-", 
    RowBox[{"2", " ", "\<\"a3_\[Omega]1\"\>", " ", "x14"}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"\<\"a4_p2\"\>", " ", "s"}], "-", 
    RowBox[{"2", " ", "\<\"a4_\[Omega]1\"\>", " ", "x14"}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.6749004041930995`*^9, 3.674900410152338*^9}, 
   3.674900449994993*^9, {3.6749063891477833`*^9, 3.6749064146851473`*^9}, {
   3.6749089721385603`*^9, 3.6749090395621924`*^9}, {3.6749094087853594`*^9, 
   3.674909421561841*^9}, {3.674909495334714*^9, 3.67490952594211*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox["1", "16"], " ", "\<\"a1_p2\"\>", " ", "\<\"a2_p2\"\>", 
    " ", "\<\"a3_p2\"\>", " ", "\<\"a4_p2\"\>", " ", 
    SuperscriptBox["s", "4"]}], ",", "0", ",", "0", ",", 
   RowBox[{
    FractionBox["1", "16"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "\<\"a1_\[Omega]1\"\>", " ", "\<\"a2_p2\"\>", 
       " ", "\<\"a3_p2\"\>", " ", "\<\"a4_p2\"\>", " ", 
       SuperscriptBox["s", "3"]}], "-", 
      RowBox[{
      "2", " ", "\<\"a1_p2\"\>", " ", "\<\"a2_\[Omega]1\"\>", 
       " ", "\<\"a3_p2\"\>", " ", "\<\"a4_p2\"\>", " ", 
       SuperscriptBox["s", "3"]}], "-", 
      RowBox[{
      "2", " ", "\<\"a1_p2\"\>", " ", "\<\"a2_p2\"\>", 
       " ", "\<\"a3_\[Omega]1\"\>", " ", "\<\"a4_p2\"\>", " ", 
       SuperscriptBox["s", "3"]}], "-", 
      RowBox[{
      "2", " ", "\<\"a1_p2\"\>", " ", "\<\"a2_p2\"\>", " ", "\<\"a3_p2\"\>", 
       " ", "\<\"a4_\[Omega]1\"\>", " ", 
       SuperscriptBox["s", "3"]}]}], ")"}]}], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.6749004041930995`*^9, 3.674900410152338*^9}, 
   3.674900449994993*^9, {3.6749063891477833`*^9, 3.6749064146851473`*^9}, {
   3.6749089721385603`*^9, 3.6749090395621924`*^9}, {3.6749094087853594`*^9, 
   3.674909421561841*^9}, {3.674909495334714*^9, 3.67490952594211*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Triple", " ", "pole", " ", "cuts"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"L", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Dim", " ", "=", " ", 
     RowBox[{"4", " ", "-", 
      RowBox[{"2", " ", "\[Epsilon]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"n", "=", "3"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ExternalMomentaBasis", "=", 
     RowBox[{"{", 
      RowBox[{"p1", ",", "p2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Massless", " ", "case"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Kinematics", "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"p1", "^", "2"}], "\[Rule]", "0"}], ",", 
       RowBox[{
        RowBox[{"p2", "^", "2"}], "\[Rule]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p1", " ", "p2"}], "\[Rule]", 
        RowBox[{"s", "/", "2"}]}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"\[Omega]1", "^", "2"}], "\[Rule]", 
        RowBox[{
         RowBox[{"-", "t"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"s", "+", "t"}], ")"}], "/", "s"}]}]}], " ", "*)"}], " ", 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Props", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"l1", ",", " ", 
       RowBox[{"l1", "+", "p1"}], ",", " ", 
       RowBox[{"l1", "-", "p2"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RenormalizationCondition", "=", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "1", "}"}], ",", "4"}], "}"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"GenerateBasis", "[", "1", "]"}], "\[IndentingNewLine]", 
   RowBox[{"Delta4", " ", "=", "Integrand"}]}]}]], "Input",
 CellChangeTimes->{{3.6749103129671555`*^9, 3.674910415288211*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Physical spacetime basis is \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"p1", ",", "p2", ",", "\[Omega]1", ",", "\[Omega]2"}], "}"}]}],
  SequenceForm[
  "Physical spacetime basis is ", {$CellContext`p1, $CellContext`p2, \
$CellContext`\[Omega]1, $CellContext`\[Omega]2}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6749104169106216`*^9}],

Cell[BoxData["\<\"Extra dimension is turned on.\"\>"], "Print",
 CellChangeTimes->{3.6749104169574223`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Number of irreducible scalar products: \"\>", 
   "\[InvisibleSpace]", "3"}],
  SequenceForm["Number of irreducible scalar products: ", 3],
  Editable->False]], "Print",
 CellChangeTimes->{3.6749104171446233`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Irreducible Scalar Products:\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"x14", ",", "x13", ",", "\[Mu]11"}], "}"}]}],
  SequenceForm[
  "Irreducible Scalar Products:", {$CellContext`x14, $CellContext`x13, \
$CellContext`\[Mu]11}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6749104171446233`*^9}],

Cell[BoxData["\<\"Cut equations for ISP are listed in the variable \
'CutEqnISP'\"\>"], "Print",
 CellChangeTimes->{3.6749104171446233`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Possible renormalizable terms: \"\>", "\[InvisibleSpace]", 
   "22"}],
  SequenceForm["Possible renormalizable terms: ", 22],
  Editable->False]], "Print",
 CellChangeTimes->{3.6749104172382236`*^9}],

Cell[BoxData["\<\"\"\>"], "Print",
 CellChangeTimes->{3.6749104172382236`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"The basis contains \"\>", "\[InvisibleSpace]", "15", 
   "\[InvisibleSpace]", "\<\" terms, which are listed in the variable 'Basis'\
\"\>"}],
  SequenceForm[
  "The basis contains ", 15, 
   " terms, which are listed in the variable 'Basis'"],
  Editable->False]], "Print",
 CellChangeTimes->{3.6749104172382236`*^9}],

Cell[BoxData["\<\"The explicit form of the integrand is listed in the \
variable 'Integrand'\"\>"], "Print",
 CellChangeTimes->{3.6749104172382236`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Number of spurious terms: \"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\", listed in the variable 'SpuriousBasis'\"\>"}],
  SequenceForm[
  "Number of spurious terms: ", 9, ", listed in the variable 'SpuriousBasis'"],
  Editable->False]], "Print",
 CellChangeTimes->{3.6749104172382236`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Number of non-spurious terms: \"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\", listed in the variable 'NSpuriousBasis'\"\>"}],
  SequenceForm[
  "Number of non-spurious terms: ", 6, 
   ", listed in the variable 'NSpuriousBasis'"],
  Editable->False]], "Print",
 CellChangeTimes->{3.6749104172382236`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Time used: \"\>", "\[InvisibleSpace]", "0.2810000000000006`", 
   "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm["Time used: ", 0.2810000000000006, " seconds"],
  Editable->False]], "Print",
 CellChangeTimes->{3.6749104172382236`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"cc", "[", 
   RowBox[{"0", ",", "0", ",", "0"}], "]"}], "+", 
  RowBox[{"\[Mu]11", " ", 
   RowBox[{"cc", "[", 
    RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["\[Mu]11", "2"], " ", 
   RowBox[{"cc", "[", 
    RowBox[{"0", ",", "0", ",", "2"}], "]"}]}], "+", 
  RowBox[{"x13", " ", 
   RowBox[{"cc", "[", 
    RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], "+", 
  RowBox[{"x13", " ", "\[Mu]11", " ", 
   RowBox[{"cc", "[", 
    RowBox[{"0", ",", "1", ",", "1"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["x13", "2"], " ", 
   RowBox[{"cc", "[", 
    RowBox[{"0", ",", "2", ",", "0"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["x13", "2"], " ", "\[Mu]11", " ", 
   RowBox[{"cc", "[", 
    RowBox[{"0", ",", "2", ",", "1"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["x13", "3"], " ", 
   RowBox[{"cc", "[", 
    RowBox[{"0", ",", "3", ",", "0"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["x13", "4"], " ", 
   RowBox[{"cc", "[", 
    RowBox[{"0", ",", "4", ",", "0"}], "]"}]}], "+", 
  RowBox[{"x14", " ", 
   RowBox[{"cc", "[", 
    RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], "+", 
  RowBox[{"x14", " ", "\[Mu]11", " ", 
   RowBox[{"cc", "[", 
    RowBox[{"1", ",", "0", ",", "1"}], "]"}]}], "+", 
  RowBox[{"x13", " ", "x14", " ", 
   RowBox[{"cc", "[", 
    RowBox[{"1", ",", "1", ",", "0"}], "]"}]}], "+", 
  RowBox[{"x13", " ", "x14", " ", "\[Mu]11", " ", 
   RowBox[{"cc", "[", 
    RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["x13", "2"], " ", "x14", " ", 
   RowBox[{"cc", "[", 
    RowBox[{"1", ",", "2", ",", "0"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["x13", "3"], " ", "x14", " ", 
   RowBox[{"cc", "[", 
    RowBox[{"1", ",", "3", ",", "0"}], "]"}]}]}]], "Output",
 CellChangeTimes->{3.6749104172538238`*^9}]
}, Open  ]]
},
WindowSize->{1313, 990},
WindowMargins->{{Automatic, 177}, {Automatic, 0}},
Magnification:>1.25 Inherited,
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (September 9, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 363, 6, 36, "Input"],
Cell[CellGroupData[{
Cell[946, 30, 670, 14, 83, "Input"],
Cell[1619, 46, 345, 5, 36, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2001, 56, 3820, 91, 382, "Input"],
Cell[CellGroupData[{
Cell[5846, 151, 637, 12, 27, "Print"],
Cell[6486, 165, 347, 4, 27, "Print"],
Cell[6836, 171, 504, 9, 27, "Print"],
Cell[7343, 182, 577, 11, 27, "Print"],
Cell[7923, 195, 382, 5, 27, "Print"],
Cell[8308, 202, 486, 9, 27, "Print"],
Cell[8797, 213, 318, 4, 27, "Print"],
Cell[9118, 219, 604, 12, 27, "Print"],
Cell[9725, 233, 392, 5, 27, "Print"],
Cell[10120, 240, 596, 10, 27, "Print"],
Cell[10719, 252, 610, 11, 27, "Print"],
Cell[11332, 265, 537, 9, 27, "Print"]
}, Open  ]],
Cell[11884, 277, 1012, 24, 38, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12933, 306, 254, 3, 83, "Input"],
Cell[13190, 311, 198, 4, 36, "Output"],
Cell[13391, 317, 619, 18, 38, "Output"],
Cell[14013, 337, 493, 14, 41, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14543, 356, 1316, 23, 152, "Input"],
Cell[15862, 381, 440, 11, 51, "Output"],
Cell[16305, 394, 300, 6, 36, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16642, 405, 508, 11, 83, "Input"],
Cell[17153, 418, 270, 5, 36, "Output"],
Cell[17426, 425, 197, 3, 36, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17660, 433, 346, 7, 60, "Input"],
Cell[18009, 442, 3143, 95, 149, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21189, 542, 585, 12, 36, "Input"],
Cell[21777, 556, 516, 14, 63, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22330, 575, 1318, 26, 106, "Input"],
Cell[23651, 603, 759, 15, 36, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24447, 623, 2465, 56, 336, "Input"],
Cell[26915, 681, 1608, 41, 60, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28560, 727, 637, 12, 60, "Input"],
Cell[29200, 741, 387, 7, 51, "Output"]
}, Open  ]],
Cell[29602, 751, 373, 9, 36, "Input"],
Cell[CellGroupData[{
Cell[30000, 764, 1277, 30, 106, "Input"],
Cell[31280, 796, 792, 21, 38, "Output"],
Cell[32075, 819, 356, 7, 51, "Output"],
Cell[32434, 828, 438, 10, 51, "Output"]
}, Open  ]],
Cell[32887, 841, 180, 4, 36, "Input"],
Cell[CellGroupData[{
Cell[33092, 849, 1046, 25, 83, "Input"],
Cell[34141, 876, 387, 7, 36, "Output"],
Cell[34531, 885, 547, 10, 36, "Output"],
Cell[35081, 897, 547, 10, 36, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35665, 912, 1762, 40, 106, "Input"],
Cell[37430, 954, 916, 17, 54, "Output"],
Cell[38349, 973, 970, 19, 54, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39356, 997, 418, 9, 36, "Input"],
Cell[39777, 1008, 330, 7, 36, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40144, 1020, 1613, 37, 106, "Input"],
Cell[41760, 1059, 470, 11, 54, "Output"],
Cell[42233, 1072, 524, 13, 54, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42794, 1090, 718, 17, 60, "Input"],
Cell[43515, 1109, 226, 4, 38, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43778, 1118, 888, 22, 106, "Input"],
Cell[44669, 1142, 365, 7, 36, "Output"],
Cell[45037, 1151, 367, 7, 36, "Output"],
Cell[45407, 1160, 313, 7, 54, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45757, 1172, 735, 17, 106, "Input"],
Cell[46495, 1191, 735, 21, 54, "Output"],
Cell[47233, 1214, 364, 9, 54, "Output"],
Cell[47600, 1225, 364, 9, 54, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48001, 1239, 1385, 33, 129, "Input"],
Cell[49389, 1274, 961, 23, 54, "Output"],
Cell[50353, 1299, 1364, 30, 96, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51754, 1334, 2041, 56, 359, "Input"],
Cell[CellGroupData[{
Cell[53820, 1394, 409, 9, 27, "Print"],
Cell[54232, 1405, 107, 1, 27, "Print"],
Cell[54342, 1408, 262, 6, 27, "Print"],
Cell[54607, 1416, 367, 9, 27, "Print"],
Cell[54977, 1427, 140, 2, 27, "Print"],
Cell[55120, 1431, 248, 6, 27, "Print"],
Cell[55371, 1439, 78, 1, 27, "Print"],
Cell[55452, 1442, 366, 9, 27, "Print"],
Cell[55821, 1453, 152, 2, 27, "Print"],
Cell[55976, 1457, 356, 7, 27, "Print"],
Cell[56335, 1466, 370, 8, 27, "Print"],
Cell[56708, 1476, 294, 6, 27, "Print"]
}, Open  ]],
Cell[57017, 1485, 1842, 53, 87, "Output"]
}, Open  ]]
}
]
*)

