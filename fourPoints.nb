(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     28439,        827]
NotebookOptionsPosition[     25853,        736]
NotebookOutlinePosition[     26199,        751]
CellTagsIndexPosition[     26156,        748]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"fourPoints", ".", "nb"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.6740566130807457`*^9, 3.674056618977659*^9}, {
  3.674056671971878*^9, 3.6740568149486275`*^9}, {3.674403468377522*^9, 
  3.674403482417612*^9}, {3.6744035481876335`*^9, 3.6744035865170794`*^9}, {
  3.6745647415351872`*^9, 3.674564744639607*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Import", " ", 
     RowBox[{"Zhang", "'"}], "s", " ", "file"}], ",", " ", 
    RowBox[{"using", " ", "relative", " ", 
     RowBox[{"path", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Import", "[", "\"\<BasisDet-1-02.m\>\"", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.674056816524253*^9, 3.674056887427162*^9}, {
   3.6740569183467584`*^9, 3.674056995552148*^9}, 3.6742342604465113`*^9, {
   3.6742345476131525`*^9, 3.6742345967378674`*^9}, 3.674403173083229*^9}],

Cell[BoxData["\<\"\\\\\\\\Client\\\\C$\\\\Users\\\\RSameshima\\\\Desktop\\\\\
Mathematica\"\>"], "Output",
 CellChangeTimes->{{3.6745650138505325`*^9, 3.674565027861729*^9}, 
   3.6745806266946764`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"D", " ", "=", " ", 
     RowBox[{"4", " ", "-", " ", 
      RowBox[{"2", " ", "\[Epsilon]"}]}]}], ",", " ", 
    RowBox[{"one", " ", "loop"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Essentially", " ", "copy", " ", "and", " ", "paste", " ", "from", " ", 
    "Zhang`s", " ", 
    RowBox[{"code", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"L", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Dim", " ", "=", " ", 
     RowBox[{"4", " ", "-", 
      RowBox[{"2", " ", "\[Epsilon]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"n", "=", "4"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ExternalMomentaBasis", "=", 
     RowBox[{"{", 
      RowBox[{"p1", ",", "p2", ",", "p4"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Massless", " ", "case"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Kinematics", "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"p1", "^", "2"}], "\[Rule]", "0"}], ",", 
       RowBox[{
        RowBox[{"p2", "^", "2"}], "\[Rule]", "0"}], ",", 
       RowBox[{
        RowBox[{"p4", "^", "2"}], "\[Rule]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p1", " ", "p2"}], "\[Rule]", 
        RowBox[{"s", "/", "2"}]}], ",", 
       RowBox[{
        RowBox[{"p1", " ", "p4"}], "\[Rule]", 
        RowBox[{"t", "/", "2"}]}], ",", 
       RowBox[{
        RowBox[{"p2", " ", "p4"}], "\[Rule]", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{"s", "+", "t"}], ")"}]}], "/", "2"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Omega]1", "^", "2"}], "\[Rule]", 
        RowBox[{
         RowBox[{"-", "t"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"s", "+", "t"}], ")"}], "/", "s"}]}]}]}], " ", 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Props", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"l1", ",", " ", 
       RowBox[{"l1", "+", "p1"}], ",", " ", 
       RowBox[{"l1", "+", "p1", "+", "p2"}], ",", " ", 
       RowBox[{"l1", "-", "p4"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RenormalizationCondition", "=", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "1", "}"}], ",", "4"}], "}"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"GenerateBasis", "[", "1", "]"}], "\[IndentingNewLine]", 
   RowBox[{"Delta4", " ", "=", " ", "Integrand"}]}]}]], "Input",
 CellChangeTimes->{{3.674057017267627*^9, 3.674057375758556*^9}, {
   3.674057464460725*^9, 3.6740575072985992`*^9}, {3.6740575453940434`*^9, 
   3.6740575730530205`*^9}, {3.6740576911925783`*^9, 3.674057708945492*^9}, {
   3.674242438361353*^9, 3.6742424485170174`*^9}, {3.674315486090181*^9, 
   3.6743154967294493`*^9}, {3.6743155703619213`*^9, 3.674315576773562*^9}, {
   3.6743156449927993`*^9, 3.6743156815906343`*^9}, {3.6743157638655615`*^9, 
   3.674315778108453*^9}, {3.6743158256419573`*^9, 3.6743158513977222`*^9}, {
   3.6743159038452587`*^9, 3.67431590567047*^9}, {3.67431593832148*^9, 
   3.6743159421123037`*^9}, {3.6743159897394094`*^9, 3.67431603660211*^9}, {
   3.6743160718762426`*^9, 3.6743160939971848`*^9}, {3.6743161959594383`*^9, 
   3.674316197347847*^9}, {3.6744027418964653`*^9, 3.6744027422864676`*^9}, 
   3.6744036701648154`*^9, {3.6744039939760914`*^9, 3.6744040221186714`*^9}, {
   3.6745649301715965`*^9, 3.674564982525532*^9}, {3.6745650392654023`*^9, 
   3.6745650639447603`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Physical spacetime basis is \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"p1", ",", "p2", ",", "p4", ",", "\[Omega]1"}], "}"}]}],
  SequenceForm[
  "Physical spacetime basis is ", {$CellContext`p1, $CellContext`p2, \
$CellContext`p4, $CellContext`\[Omega]1}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.674565031621353*^9, 3.674565064584365*^9}, 
   3.674580630048698*^9}],

Cell[BoxData["\<\"Extra dimension is turned on.\"\>"], "Print",
 CellChangeTimes->{{3.674565031621353*^9, 3.674565064584365*^9}, 
   3.6745806301110983`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Number of irreducible scalar products: \"\>", 
   "\[InvisibleSpace]", "2"}],
  SequenceForm["Number of irreducible scalar products: ", 2],
  Editable->False]], "Print",
 CellChangeTimes->{{3.674565031621353*^9, 3.674565064584365*^9}, 
   3.674580630173499*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Irreducible Scalar Products:\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"x14", ",", "\[Mu]11"}], "}"}]}],
  SequenceForm[
  "Irreducible Scalar Products:", {$CellContext`x14, $CellContext`\[Mu]11}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.674565031621353*^9, 3.674565064584365*^9}, 
   3.674580630173499*^9}],

Cell[BoxData["\<\"Cut equations for ISP are listed in the variable \
'CutEqnISP'\"\>"], "Print",
 CellChangeTimes->{{3.674565031621353*^9, 3.674565064584365*^9}, 
   3.674580630173499*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Possible renormalizable terms: \"\>", "\[InvisibleSpace]", 
   "9"}],
  SequenceForm["Possible renormalizable terms: ", 9],
  Editable->False]], "Print",
 CellChangeTimes->{{3.674565031621353*^9, 3.674565064584365*^9}, 
   3.674580630220299*^9}],

Cell[BoxData["\<\"\"\>"], "Print",
 CellChangeTimes->{{3.674565031621353*^9, 3.674565064584365*^9}, 
   3.674580630220299*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"The basis contains \"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\" terms, which are listed in the variable 'Basis'\
\"\>"}],
  SequenceForm[
  "The basis contains ", 5, 
   " terms, which are listed in the variable 'Basis'"],
  Editable->False]], "Print",
 CellChangeTimes->{{3.674565031621353*^9, 3.674565064584365*^9}, 
   3.674580630235899*^9}],

Cell[BoxData["\<\"The explicit form of the integrand is listed in the \
variable 'Integrand'\"\>"], "Print",
 CellChangeTimes->{{3.674565031621353*^9, 3.674565064584365*^9}, 
   3.674580630235899*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Number of spurious terms: \"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\", listed in the variable 'SpuriousBasis'\"\>"}],
  SequenceForm[
  "Number of spurious terms: ", 2, ", listed in the variable 'SpuriousBasis'"],
  Editable->False]], "Print",
 CellChangeTimes->{{3.674565031621353*^9, 3.674565064584365*^9}, 
   3.674580630235899*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Number of non-spurious terms: \"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\", listed in the variable 'NSpuriousBasis'\"\>"}],
  SequenceForm[
  "Number of non-spurious terms: ", 3, 
   ", listed in the variable 'NSpuriousBasis'"],
  Editable->False]], "Print",
 CellChangeTimes->{{3.674565031621353*^9, 3.674565064584365*^9}, 
   3.674580630235899*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Time used: \"\>", "\[InvisibleSpace]", "0.17199999999999882`", 
   "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm["Time used: ", 0.17199999999999882`, " seconds"],
  Editable->False]], "Print",
 CellChangeTimes->{{3.674565031621353*^9, 3.674565064584365*^9}, 
   3.674580630251499*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"cc", "[", 
   RowBox[{"0", ",", "0"}], "]"}], "+", 
  RowBox[{"\[Mu]11", " ", 
   RowBox[{"cc", "[", 
    RowBox[{"0", ",", "1"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["\[Mu]11", "2"], " ", 
   RowBox[{"cc", "[", 
    RowBox[{"0", ",", "2"}], "]"}]}], "+", 
  RowBox[{"x14", " ", 
   RowBox[{"cc", "[", 
    RowBox[{"1", ",", "0"}], "]"}]}], "+", 
  RowBox[{"x14", " ", "\[Mu]11", " ", 
   RowBox[{"cc", "[", 
    RowBox[{"1", ",", "1"}], "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.674316105026455*^9, 3.6743162108419333`*^9, 3.6743162782811656`*^9, 
   3.674403677746464*^9, 3.674403997751315*^9, 3.6744741921573877`*^9, 
   3.674496024106584*^9, {3.674564950904129*^9, 3.6745650000756445`*^9}, {
   3.6745650333529644`*^9, 3.674565064787166*^9}, 3.674580630251499*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["CutEqnISP"], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"4", " ", 
    SuperscriptBox["t", "2"], " ", "\[Mu]11"}], "+", 
   RowBox[{"s", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["t", "2"]}], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["x14", "2"]}], "+", 
      RowBox[{"4", " ", "t", " ", "\[Mu]11"}]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6742364375800867`*^9, 3.67423645063737*^9}, 
   3.6742414733235664`*^9, {3.6742424539458523`*^9, 3.6742424672215376`*^9}, 
   3.6744041757796564`*^9, 3.6744741962446136`*^9, {3.674565053289892*^9, 
   3.674565070746404*^9}, 3.674580636372651*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cutEqFor4", " ", "=", "CutEqnISP"}]], "Input",
 CellChangeTimes->{{3.6742312547571187`*^9, 3.67423139841844*^9}, {
   3.674231629580721*^9, 3.674231653994878*^9}, 3.6742317237429247`*^9, {
   3.674231905109688*^9, 3.6742319153433533`*^9}, {3.674231965123272*^9, 
   3.6742320442157793`*^9}, {3.6742322459406724`*^9, 3.674232296422596*^9}, {
   3.6742323273731947`*^9, 3.674232373081487*^9}, {3.6742324632968655`*^9, 
   3.6742324725477247`*^9}, {3.674232588191266*^9, 3.674232590671682*^9}, {
   3.674242290363204*^9, 3.674242291018408*^9}, {3.674242325182627*^9, 
   3.674242389252238*^9}, {3.674242554348096*^9, 3.6742425647221622`*^9}, {
   3.674243608384453*^9, 3.6742436137196865`*^9}, {3.674246338760755*^9, 
   3.674246368135743*^9}, 3.6742484029035864`*^9, 3.6744043292534404`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"4", " ", 
    SuperscriptBox["t", "2"], " ", "\[Mu]11"}], "+", 
   RowBox[{"s", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["t", "2"]}], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["x14", "2"]}], "+", 
      RowBox[{"4", " ", "t", " ", "\[Mu]11"}]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.674565115768293*^9, 3.674580638759467*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "Here", " ", "we", " ", "have", " ", "an", " ", "acceess", " ", "to", " ",
      "the", " ", "internal", " ", "expression", " ", "of", " ", "RSP"}], ",",
     " ", 
    RowBox[{
     RowBox[{"where", " ", "\[IndentingNewLine]", "xij"}], " ", ":=", " ", 
     RowBox[{"li", ".", "ej", "."}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"RSPSolution", "\[IndentingNewLine]", "ISP"}]}]], "Input",
 CellChangeTimes->{{3.6742312547571187`*^9, 3.67423139841844*^9}, {
   3.674231629580721*^9, 3.674231653994878*^9}, 3.6742317237429247`*^9, {
   3.674231905109688*^9, 3.6742319153433533`*^9}, {3.674231965123272*^9, 
   3.6742320442157793`*^9}, {3.6742322459406724`*^9, 3.674232296422596*^9}, {
   3.6742323273731947`*^9, 3.674232373081487*^9}, {3.6742324632968655`*^9, 
   3.6742324725477247`*^9}, {3.674232588191266*^9, 3.674232590671682*^9}, {
   3.674242290363204*^9, 3.674242291018408*^9}, {3.674242325182627*^9, 
   3.674242389252238*^9}, {3.674242554348096*^9, 3.6742425647221622`*^9}, {
   3.674243608384453*^9, 3.6742436137196865`*^9}, {3.674246338760755*^9, 
   3.674246368135743*^9}, {3.6742484029035864`*^9, 3.6742484125912485`*^9}, {
   3.674404318567372*^9, 3.6744043485039635`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"x11", "\[Rule]", "0"}], ",", 
   RowBox[{"x12", "\[Rule]", 
    RowBox[{"-", 
     FractionBox["s", "2"]}]}], ",", 
   RowBox[{"x13", "\[Rule]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6743159549823866`*^9, 3.6744042555117674`*^9, {3.6744044093131533`*^9, 
   3.674404412869976*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"x14", ",", "\[Mu]11"}], "}"}]], "Output",
 CellChangeTimes->{
  3.6743159549823866`*^9, 3.6744042555117674`*^9, {3.6744044093131533`*^9, 
   3.674404412869976*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "These", " ", "are", " ", "the", " ", "variables", " ", "in", " ", "our", 
     " ", "numerator", " ", "function", " ", "N", 
     RowBox[{"(", "l", ")"}]}], ":"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Props", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Props", "[", 
     RowBox[{"[", "1", "]"}], "]"}], " ", ".", " ", 
    RowBox[{"Props", "[", 
     RowBox[{"[", "2", "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"Length", "[", "Props", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6742330900646095`*^9, 3.6742331339476905`*^9}, {
  3.674404699069411*^9, 3.6744047127350984`*^9}, {3.674404977718397*^9, 
  3.674404979091206*^9}, {3.6744052764915123`*^9, 3.6744053029336815`*^9}, {
  3.674474251484568*^9, 3.6744742995016756`*^9}, {3.6744745275127373`*^9, 
  3.67447456069415*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"l1", ",", 
   RowBox[{"l1", "+", "p1"}], ",", 
   RowBox[{"l1", "+", "p1", "+", "p2"}], ",", 
   RowBox[{"l1", "-", "p4"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6744047033126383`*^9, 3.6744049798868113`*^9, 3.674405303854088*^9, {
   3.674474243356916*^9, 3.67447430012568*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"l1", ".", "l1"}], "+", 
  RowBox[{"l1", ".", "p1"}]}]], "Output",
 CellChangeTimes->{
  3.6744047033126383`*^9, 3.6744049798868113`*^9, 3.674405303854088*^9, {
   3.674474243356916*^9, 3.67447430012568*^9}}],

Cell[BoxData["4"], "Output",
 CellChangeTimes->{
  3.6744047033126383`*^9, 3.6744049798868113`*^9, 3.674405303854088*^9, {
   3.674474243356916*^9, 3.67447430012568*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Here", " ", "we", " ", "can", " ", "access", " ", "to", " ", "the", " ", 
    "basis", " ", "for", " ", "physical", " ", 
    RowBox[{"timespace", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"SpacetimeBasis", "\[IndentingNewLine]", 
   RowBox[{"SpacetimeBasis", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.674475016310671*^9, 3.6744750620033636`*^9}, {
  3.674475536059202*^9, 3.674475539756426*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"p1", ",", "p2", ",", "p4", ",", "\[Omega]1"}], "}"}]], "Output",
 CellChangeTimes->{3.674475004345394*^9, 3.6744755406144314`*^9}],

Cell[BoxData["p2"], "Output",
 CellChangeTimes->{3.674475004345394*^9, 3.6744755406144314`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"He", " ", "already", " ", "made", " ", "it"}], "..."}], " ", 
   "*)"}], "\[IndentingNewLine]", "ScalarProductRules"}]], "Input",
 CellChangeTimes->{{3.674477227172443*^9, 3.6744772323984766`*^9}, 
   3.6744775573641596`*^9, {3.6744776716504917`*^9, 3.6744776815253553`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SuperscriptBox["l1", "2"], "\[Rule]", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{
        SuperscriptBox["t", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x11", "+", "x12"}], ")"}], "2"]}], "+", 
       RowBox[{"2", " ", "s", " ", "t", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x11", "2"], "-", 
          RowBox[{"x12", " ", "x13"}], "+", 
          RowBox[{"x11", " ", 
           RowBox[{"(", 
            RowBox[{"x12", "+", "x13"}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["s", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x11", "2"], "+", 
          RowBox[{"2", " ", "x11", " ", "x13"}], "+", 
          SuperscriptBox["x13", "2"], "-", 
          SuperscriptBox["x14", "2"]}], ")"}]}]}], 
      RowBox[{"s", " ", "t", " ", 
       RowBox[{"(", 
        RowBox[{"s", "+", "t"}], ")"}]}]], "-", "\[Mu]11"}]}], ",", 
   RowBox[{
    RowBox[{"l1", " ", "p1"}], "\[Rule]", "x11"}], ",", 
   RowBox[{
    RowBox[{"l1", " ", "p2"}], "\[Rule]", "x12"}], ",", 
   RowBox[{
    RowBox[{"l1", " ", "p4"}], "\[Rule]", "x13"}], ",", 
   RowBox[{
    RowBox[{"l1", " ", "\[Omega]1"}], "\[Rule]", "x14"}], ",", 
   RowBox[{
    RowBox[{"l1", " ", "p3"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", "x11"}], "-", "x12", "-", "x13"}]}], ",", 
   RowBox[{
    SuperscriptBox["p1", "2"], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"p1", " ", "p2"}], "\[Rule]", 
    FractionBox["s", "2"]}], ",", 
   RowBox[{
    RowBox[{"p1", " ", "p4"}], "\[Rule]", 
    FractionBox["t", "2"]}], ",", 
   RowBox[{
    RowBox[{"p1", " ", "\[Omega]1"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"p1", " ", "p3"}], "\[Rule]", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "s"}], "-", "t"}], ")"}]}]}], ",", 
   RowBox[{
    SuperscriptBox["p2", "2"], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"p2", " ", "p4"}], "\[Rule]", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "s"}], "-", "t"}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{"p2", " ", "\[Omega]1"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"p2", " ", "p3"}], "\[Rule]", 
    FractionBox["t", "2"]}], ",", 
   RowBox[{
    SuperscriptBox["p4", "2"], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"p4", " ", "\[Omega]1"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"p3", " ", "p4"}], "\[Rule]", 
    FractionBox["s", "2"]}], ",", 
   RowBox[{
    SuperscriptBox["\[Omega]1", "2"], "\[Rule]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"t", " ", 
       RowBox[{"(", 
        RowBox[{"s", "+", "t"}], ")"}]}], "s"]}]}], ",", 
   RowBox[{
    RowBox[{"p3", " ", "\[Omega]1"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    SuperscriptBox["p3", "2"], "\[Rule]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6744772329756804`*^9, 3.6744775583157654`*^9, 
  3.6745806418482866`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"l1", " ", "p1"}], "  ", "+", " ", 
     RowBox[{"l1", "^", "2"}]}], " ", "/.", " ", "ScalarProductRules"}], " ", 
   "/.", " ", "RSPSolution"}], " ", "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.6744759865900908`*^9, 3.6744760025801926`*^9}, {
  3.6744762386565065`*^9, 3.6744762588898363`*^9}, {3.674476805345739*^9, 
  3.674476814627798*^9}, {3.6744775706242447`*^9, 3.6744776435547123`*^9}, {
  3.6745651412744565`*^9, 3.6745651642534037`*^9}, {3.6745653498945937`*^9, 
  3.6745653510490007`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"s", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["t", "2"], "-", 
      RowBox[{"4", " ", 
       SuperscriptBox["x14", "2"]}]}], ")"}]}], 
   RowBox[{"4", " ", "t", " ", 
    RowBox[{"(", 
     RowBox[{"s", "+", "t"}], ")"}]}]], "-", "\[Mu]11"}]], "Output",
 CellChangeTimes->{{3.6744775878623548`*^9, 3.67447764478712*^9}, 
   3.6745651659382143`*^9, 3.6745653564466352`*^9, 3.6745806458731127`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rewritingRuleForPolarization", " ", "=", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"l1", " ", "aVector_"}], " ", "\[Rule]", " ", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ToExpression", "[", 
        RowBox[{"\"\<x1\>\"", "  ", "<>", " ", 
         RowBox[{"ToString", "[", "j", "]"}]}], "]"}], " ", 
       RowBox[{"SpacetimeBasis", "[", 
        RowBox[{"[", "j", "]"}], "]"}], "  ", "aVector"}], " ", ",", " ", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", "}"}]}]], "Input",
 CellChangeTimes->{{3.674566350337502*^9, 3.674566360275403*^9}, {
  3.674566522604848*^9, 3.6745665276596045`*^9}, {3.6745665582533617`*^9, 
  3.6745666468186045`*^9}, {3.6745670713043766`*^9, 3.674567077029687*^9}, {
  3.6745807644494724`*^9, 3.674580778754764*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"l1", " ", "aVector_"}], "\[Rule]", 
   RowBox[{
    RowBox[{"aVector", " ", "p1", " ", "x11"}], "+", 
    RowBox[{"aVector", " ", "p2", " ", "x12"}], "+", 
    RowBox[{"aVector", " ", "p4", " ", "x13"}], "+", 
    RowBox[{"aVector", " ", "x14", " ", "\[Omega]1"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.6745670785429153`*^9, 3.674580650818344*^9, 
  3.674580780189973*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"l1", " ", "p2"}], " ", "+", " ", 
   RowBox[{"l1", " ", "e1"}], " ", "+", " ", 
   RowBox[{"p1", " ", "p1"}]}], " ", "/.", " ", 
  "ScalarProductRules"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"e1", " ", "l1"}], "+", "x12"}]], "Output",
 CellChangeTimes->{3.6745809915401278`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"l1", " ", "p2"}], " ", "+", " ", 
    RowBox[{"l1", " ", "e1"}], " ", "+", " ", 
    RowBox[{"p1", " ", "p1"}]}], " ", "/.", " ", "ScalarProductRules"}], " ", 
  "/.", "rewritingRuleForPolarization"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"e1", " ", "p1", " ", "x11"}], "+", "x12", "+", 
  RowBox[{"e1", " ", "p2", " ", "x12"}], "+", 
  RowBox[{"e1", " ", "p4", " ", "x13"}], "+", 
  RowBox[{"e1", " ", "x14", " ", "\[Omega]1"}]}]], "Output",
 CellChangeTimes->{3.674581009417843*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"e2pRule", "=", "\[IndentingNewLine]", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ToExpression", "[", 
      RowBox[{"\"\<e\>\"", " ", "<>", " ", 
       RowBox[{"ToString", "[", "i", "]"}]}], "]"}], " ", "\[Rule]", " ", 
     RowBox[{"SpacetimeBasis", "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.674581256211425*^9, 3.674581382619035*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"e1", "\[Rule]", "p1"}], ",", 
   RowBox[{"e2", "\[Rule]", "p2"}], ",", 
   RowBox[{"e3", "\[Rule]", "p4"}], ",", 
   RowBox[{"e4", "\[Rule]", "\[Omega]1"}]}], "}"}]], "Output",
 CellChangeTimes->{3.674581345865199*^9, 3.6745813839762435`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"l1", " ", "p2"}], " ", "+", " ", 
     RowBox[{"l1", " ", "e1"}], " ", "+", " ", 
     RowBox[{"p1", " ", "p1"}]}], " ", "/.", " ", "ScalarProductRules"}], " ",
    "/.", "rewritingRuleForPolarization"}], " ", "/.", " ", 
  "e2pRule"}]], "Input",
 CellChangeTimes->{{3.674581395754319*^9, 3.674581406455988*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["p1", "2"], " ", "x11"}], "+", "x12", "+", 
  RowBox[{"p1", " ", "p2", " ", "x12"}], "+", 
  RowBox[{"p1", " ", "p4", " ", "x13"}], "+", 
  RowBox[{"p1", " ", "x14", " ", "\[Omega]1"}]}]], "Output",
 CellChangeTimes->{3.674581407813196*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"l1", " ", "p2"}], " ", "+", " ", 
      RowBox[{"l1", " ", "e1"}], " ", "+", " ", 
      RowBox[{"p1", " ", "p1"}]}], " ", "/.", " ", "ScalarProductRules"}], 
    " ", "/.", "rewritingRuleForPolarization"}], " ", "/.", " ", "e2pRule"}], 
  " ", "/.", " ", "ScalarProductRules"}]], "Input",
 CellChangeTimes->{{3.6745667595470953`*^9, 3.6745668193122272`*^9}, {
  3.6745808027165174`*^9, 3.6745808054153347`*^9}, {3.6745814257845116`*^9, 
  3.674581433490961*^9}}],

Cell[BoxData[
 RowBox[{"x12", "+", 
  FractionBox[
   RowBox[{"s", " ", "x12"}], "2"], "+", 
  FractionBox[
   RowBox[{"t", " ", "x13"}], "2"]}]], "Output",
 CellChangeTimes->{
  3.674567082645795*^9, 3.6745806556231747`*^9, {3.6745807847608023`*^9, 
   3.6745808065541425`*^9}, 3.674581435628175*^9}]
}, Open  ]]
},
WindowSize->{898, 990},
WindowMargins->{{Automatic, 413}, {Automatic, 0}},
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (September 9, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 363, 6, 31, "Input"],
Cell[CellGroupData[{
Cell[946, 30, 670, 14, 72, "Input"],
Cell[1619, 46, 202, 3, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1858, 54, 3725, 90, 332, "Input"],
Cell[CellGroupData[{
Cell[5608, 148, 443, 10, 23, "Print"],
Cell[6054, 160, 157, 2, 23, "Print"],
Cell[6214, 164, 310, 7, 23, "Print"],
Cell[6527, 173, 383, 9, 23, "Print"],
Cell[6913, 184, 188, 3, 23, "Print"],
Cell[7104, 189, 294, 7, 23, "Print"],
Cell[7401, 198, 126, 2, 23, "Print"],
Cell[7530, 202, 412, 10, 23, "Print"],
Cell[7945, 214, 200, 3, 23, "Print"],
Cell[8148, 219, 404, 8, 23, "Print"],
Cell[8555, 229, 418, 9, 23, "Print"],
Cell[8976, 240, 345, 7, 23, "Print"]
}, Open  ]],
Cell[9336, 250, 815, 21, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10188, 276, 35, 0, 31, "Input"],
Cell[10226, 278, 645, 16, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10908, 299, 813, 11, 31, "Input"],
Cell[11724, 312, 440, 13, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12201, 330, 1316, 23, 132, "Input"],
Cell[13520, 355, 346, 10, 44, "Output"],
Cell[13869, 367, 204, 5, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14110, 377, 878, 19, 92, "Input"],
Cell[14991, 398, 325, 8, 31, "Output"],
Cell[15319, 408, 242, 6, 31, "Output"],
Cell[15564, 416, 170, 3, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15771, 424, 508, 11, 72, "Input"],
Cell[16282, 437, 170, 3, 31, "Output"],
Cell[16455, 442, 95, 1, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16587, 448, 346, 7, 52, "Input"],
Cell[16936, 457, 3048, 94, 146, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20021, 556, 585, 12, 31, "Input"],
Cell[20609, 570, 466, 13, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21112, 588, 884, 19, 72, "Input"],
Cell[21999, 609, 429, 10, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22465, 624, 211, 6, 31, "Input"],
Cell[22679, 632, 121, 3, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22837, 640, 271, 7, 31, "Input"],
Cell[23111, 649, 279, 6, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23427, 660, 501, 12, 52, "Input"],
Cell[23931, 674, 294, 7, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24262, 686, 386, 10, 31, "Input"],
Cell[24651, 698, 293, 7, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24981, 710, 552, 13, 52, "Input"],
Cell[25536, 725, 301, 8, 46, "Output"]
}, Open  ]]
}
]
*)

